:activityType :activityTypeName """AllPrep DNA/RNA/miRNA Universal""" .
{
  ?p   :a  :SampleTube .
  ?p   :is   :NotStarted .
  ?p   :maxCardinality   """12""" .
  ?q   :maxCardinality   """0""" .
  ?r   :maxCardinality   """0""" .
} => {
  :step  :stepTypeName """Create DNA and NA+P tubes from Sample Tubes""" .
  :step :connectBy """position""" .
  :step  :createAsset  {?q   :a  :Tube .} .
  :step  :createAsset  {?q   :aliquotType  :DNA .} .
  :step  :createAsset  {?r   :a  :Tube .} .
  :step  :createAsset  {?r   :aliquotType  :NAP .} .
} .

{
  ?p   :a  :SampleTube .
  ?p   :is   :NotStarted .
  ?p   :maxCardinality   """12""" .
  ?q   :a  :Tube .
  ?q   :aliquotType  :DNA .
  ?q   :maxCardinality   """12""" .
  ?r   :a  :Tube .
  ?r   :aliquotType  :NAP .
  ?r   :maxCardinality   """12""" .
} => {
  :step  :stepTypeName """Extract DNA and NA+P""" .
  :step  :stepTemplate """transfer_tube_to_tube""" .
  :step  :unselectAsset  ?p.
  :step  :addFacts   {?p   :transfer   :q .} .
  :step  :addFacts   {?p   :transfer   :r .} .
  :step  :addFacts   {?q   :transferredFrom  :p .} .
  :step  :addFacts   {?r   :transferredFrom  :p .} .
} .

{
  ?p   :a  :SampleTube .
  ?p   :is   :NotStarted .
  ?p   :maxCardinality   """12""" .
  ?q   :a  :Tube .
  ?q   :aliquotType  :DNA .
  ?q   :maxCardinality   """12""" .
  ?r   :a  :Tube .
  ?r   :aliquotType  :NAP .
  ?r   :maxCardinality   """12""" .
} => {
  :step  :stepTypeName """(BY POSITION) Extract DNA and NA+P""" .
  :step :connectBy """position""" .
  :step  :addFacts   {?p   :transfer   :q .} .
  :step  :addFacts   {?p   :transfer   :r .} .
  :step  :addFacts   {?q   :transferredFrom  :p .} .
  :step  :addFacts   {?r   :transferredFrom  :p .} .
} .


{
  ?q   :aliquotType  :DNA .
  ?q   :maxCardinality   """0""" .
  ?r   :aliquotType  :NAP .
  ?r   :maxCardinality   """0""" .
} => {
  :step  :stepTypeName """Select just DNA tubes""" .
  :step  :unselectAsset  ?r.
  } .


{
  ?q   :aliquotType  :DNA .
  ?q   :maxCardinality   """0""" .
  ?r   :aliquotType  :NAP .
  ?r   :maxCardinality   """0""" .
} => {
  :step  :stepTypeName """Select just NA+P tubes""" .
  :step  :unselectAsset  ?q.
  } .

{
  ?Condition1  :a  :SampleTube .
  ?Condition1  :is   :NotStarted .
  ?Condition1  :maxCardinality   """12""" .
  ?Asset2  :maxCardinality   """0""" .
} => {
  :step  :stepTypeName """Create DNA tube from sample tube""" .
  :step  :createAsset  {?Asset2  :a  :Tube .} .
  :step  :createAsset  {?Asset2  :aliquotType  :DNA .} .
} .

{
  ?Condition1  :a  :SampleTube .
  ?Condition1  :is   :NotStarted .
  ?Condition1  :maxCardinality   """12""" .
  ?Asset2  :maxCardinality   """0""" .
} => {
  :step  :stepTypeName """Create RNA tube from sample tube""" .
  :step  :createAsset  {?Asset2  :aliquotType  :RNA .} .
  :step  :createAsset  {?Asset2  :a  :Tube .} .
} .

{
  ?SampleTube  :a  :SampleTube .
  ?SampleTube  :is   :NotStarted .
  ?SampleTube  :maxCardinality   """0""" .
  ?DNAtube   :a  :Tube .
  ?DNAtube   :aliquotType  :DNA .
  ?DNAtube :is :Empty.
  ?DNAtube   :maxCardinality   """0""" .
} => {
  :step  :stepTypeName """Extract DNA only""" .
  :step  :stepTemplate """transfer_tube_to_tube""" .
  :step  :unselectAsset  ?SampleTube.
  :step  :unselectAsset  ?DNAtube.
  :step  :addFacts   {?SampleTube  :transfer   :DNAtube .} .
  :step  :addFacts   {?DNAtube   :transferredFrom   :SampleTube .} .
  :step :removeFacts {?DNAtube :is :Empty.}.
} .

{
  ?DNAtube   :a  :Tube .
  ?Tube2D    :a  :Tube .
  ?Tube2D    :barcodeType :Code2D .
}=>{
  :step  :stepTypeName """Transfer to 2D tubes""" .
  :step  :stepTemplate """transfer_tube_to_tube""" .
  :step :addFacts {?DNAtube :transfer ?Tube2D.}.
  :step :addFacts {?Tube2D :transferredFrom ?DNAtube.}.
} .
